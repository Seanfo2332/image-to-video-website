{
  "nodes": [
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "14f7319f-fea9-4b2f-8b58-94350f82b6f3",
              "name": "Google cloud project id",
              "value": "",
              "type": "string"
            },
            {
              "id": "014a2454-1470-4275-953f-96217a79157a",
              "name": "Google model id",
              "value": "",
              "type": "string"
            },
            {
              "id": "e6281b2f-96b5-4e72-8469-40fd50fa50f4",
              "name": "Google AI Studio API_KEY",
              "value": "",
              "type": "string"
            },
            {
              "id": "b537c9bd-8b3c-4bf1-88df-feab64ed5559",
              "name": "Google Cloud Storage Bucket name",
              "value": "",
              "type": "string"
            },
            {
              "id": "7ec01e14-2ac1-4e73-b58d-ae931f1c2ae1",
              "name": "KIE API_KEY",
              "value": "5fc0241687cbf50ff76ec415096c9388",
              "type": "string"
            },
            {
              "id": "a7849559-c38b-4791-b455-35dc8de82b01",
              "name": "Minimax API_KEY",
              "value": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJHcm91cE5hbWUiOiJuOG4gU2VhbiIsIlVzZXJOYW1lIjoibjhuIiwiQWNjb3VudCI6IiIsIlN1YmplY3RJRCI6IjIwMDM2NjQwODk3Mjg5NDcwNDciLCJQaG9uZSI6IiIsIkdyb3VwSUQiOiIyMDAzNjY0MDg5NzI0NzU2ODM5IiwiUGFnZU5hbWUiOiIiLCJNYWlsIjoibjhuc2VhbkBnbWFpbC5jb20iLCJDcmVhdGVUaW1lIjoiMjAyNS0xMi0yNCAxNTo0Mzo0MiIsIlRva2VuVHlwZSI6MSwiaXNzIjoibWluaW1heCJ9.ZuyGjAhKE1cGhYkrFgCPOlwp9j6tVvVE91H-KYW_5sJsRynu2oq9MQH0LNJCIYR2r7oDLdanXLCffFlhdm4sG1TksrSfOfebqga-exHn-obEgaSAGev2-cmNbzFvY9gyN9Rsche05hGcfJlaYvvNnxv6C39hHaLOSW5M-HNCYkEBVGSThLUHCyc8nmT9A9FfhpcKbUTWlxGPMmq-mcOKoAyWNA2_SDV-Nk-0QN4YfxLa9lF19tKnggQkH9ItyYqlVT6Ol6OnCdEKbEgaQQZr8s00_uEMqOVsvD3PuIxwhM-Tqn2wy40h9wW_8Qdl1MXgno5TWzNupe-TzHwrnd080A",
              "type": "string"
            },
            {
              "id": "ee59e920-f2e2-4537-a989-2c8cb04faf12",
              "name": "Running Hub API_KEY",
              "value": "aa96594a94844d19bfdbeb40999b63e7",
              "type": "string"
            },
            {
              "id": "2505be6c-3490-47c4-b2c2-25ae937bf7cc",
              "name": "NCA url",
              "value": "",
              "type": "string"
            },
            {
              "id": "660e503b-3c1b-409c-ac5e-0b94f7d93290",
              "name": "NCA api key",
              "value": "",
              "type": "string"
            },
            {
              "id": "abe8fd36-8f75-49d9-b2bc-35e7aa0ae646",
              "name": "è§†é¢‘åˆå¹¶ url",
              "value": "",
              "type": "string"
            },
            {
              "id": "354e8e7c-6077-472b-9ada-3a45aebd22a4",
              "name": "è§†é¢‘åˆå¹¶ API_KEY",
              "value": "",
              "type": "string"
            },
            {
              "id": "f0e696fa-b603-462a-8017-bce08af43455",
              "name": "ç¼–å·",
              "value": "={{ $workflow.id }}-{{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1328,
        480
      ],
      "id": "e8a7692e-441d-40f0-861b-5a250079c931",
      "name": "è®¾ç½®å‚æ•°-ç»¼åˆ"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "ab3f04df-b5a3-4692-9b27-e76e000527dc",
              "name": "è„šæœ¬",
              "value": "=ä½ æ˜¯"åˆ†é•œä¸å£æ’­ç¼–æ’å™¨"ã€‚ä½ çš„è¾“å…¥æ˜¯ä¸€æ®µ**è„šæœ¬åŸæ–‡**ã€‚\nè¯·ä¸¥æ ¼éµå®ˆä»¥ä¸‹è§„åˆ™ï¼Œä»…è¾“å‡º**ä¸€ä¸ªåˆæ³• JSON å¯¹è±¡**ï¼Œä¸å¾—åŒ…å«é¢å¤–æ–‡å­—ã€Markdown æˆ–æ³¨é‡Šã€‚\n\n---\n\n## ğŸ’ æ ¸å¿ƒçº¦æŸ\n\n1. **ç»ä¸ä¿®æ”¹è„šæœ¬åŸæ–‡**ï¼ˆåŒ…æ‹¬æ ‡ç‚¹ã€è¯­åºã€å­—è¯ï¼‰ã€‚\n2. æ ¹æ®è„šæœ¬è¯­ä¹‰ã€èŠ‚å¥ã€è¯­æ°”å˜åŒ–ï¼Œå°†å…¨æ–‡æ‹†æˆè‹¥å¹² `storyboards`ã€‚\n3. æ¯ä¸ªåˆ†é•œéƒ½å¿…é¡»åŒ…å«ï¼š\n\n   * `scene_id`: æ•´æ•°ï¼Œä» 1 å¼€å§‹é€’å¢ã€‚\n   * `narration_script`: åŸæ–‡ä¸­å¯¹åº”çš„å®Œæ•´å¥æ®µï¼ˆé€å­—ä¿ç•™ï¼‰ã€‚\n   * `speaking`: `\"Yes\"` æˆ– `\"No\"`\n\n     * `\"Yes\"` â†’ é™æ€ç”»é¢ã€å£æ’­é‡ç‚¹ã€‚\n     * `\"No\"` â†’ æœ‰ç”»é¢å˜åŒ–æˆ–åˆ†é•œåˆ‡æ¢ï¼ŒåŒæ—¶å£æ’­**ç»§ç»­æ’­æ”¾**ã€‚\n   * å½“ `\"speaking\":\"No\"` æ—¶ï¼Œ**å¿…é¡»é¢å¤–æ·»åŠ  `visual` å­—æ®µ**ï¼Œç”¨æ¥ç”Ÿæˆ Veo3 çš„è§†è§‰æç¤ºã€‚\n\n---\n\n## ğŸ§© è¾“å‡ºæ¨¡æ¿\n\n```\n{\n  \"storyboards\": [\n    {\n      \"scene_id\": 1,\n      \"narration_script\": \"\",\n      \"speaking\": \"Yes\"\n    },\n    {\n      \"scene_id\": 2,\n      \"narration_script\": \"\",\n      \"speaking\": \"Yes\"\n    }\n  ],\n  \"analysis_summary\": {\n    \"structure_logic\": \"åå¸¸è¯†â†’ç ´æ—§è§‚â†’ç«‹æ–°çŸ¥â†’å¤šç»´è®ºè¯â†’å‡åâ†’å›å½’ä¸ªä½“\",\n    \"emotion_curve\": \"ç„¦è™‘â†’å…±é¸£â†’é‡Šç„¶â†’å¸Œæœ›\",\n    \"target_audience\": \"è¢«ç¤¾ä¼šèŠ‚å¥å‹è¿«ã€æ¸´æœ›æ„ä¹‰çš„å¹´è½»èŒåœºäºº\",\n    \"human_insight\": \"ä»–ä»¬ä¸æ˜¯ä¸æƒ³åŠªåŠ›ï¼Œè€Œæ˜¯åŠªåŠ›å¤±å»äº†æ„ä¹‰æ„Ÿã€‚\",\n    \"video_duration_estimate\": \"AI æ¨ç®—æ€»æ—¶é•¿ï¼ˆ1â€“7åˆ†é’Ÿï¼‰\"\n  }\n}\n```\n\n---\n\n## ğŸ§  æ“ä½œé€»è¾‘\n\n1. æŒ‰è¯­ä¹‰èŠ‚å¥åˆ‡åˆ†è„šæœ¬ã€‚\n2. æ¯æ®µéƒ½æ”¾å…¥ `narration_script`ï¼ˆåŸæ–‡é€å­—ä¿ç•™ï¼‰ã€‚\n3. åˆ¤å®šï¼š* è‹¥è¯¥æ®µéœ€å£æ’­ä¸ºä¸» â†’ `\"speaking\":\"Yes\"`\n4. æ‰€æœ‰å¥æ®µå¿…é¡»è¢«è¦†ç›–ï¼Œä¸å¾—é‡å¤æˆ–é—æ¼ã€‚\n5. `analysis_summary` æŒ‰ä¸‹åˆ—è¯´æ˜å¡«å†™ï¼š\n   * `structure_logic`: `\"åå¸¸è¯†â†’ç ´æ—§è§‚â†’ç«‹æ–°çŸ¥â†’å¤šç»´è®ºè¯â†’å‡åâ†’å›å½’ä¸ªä½“\"`\n   * `emotion_curve`: ä»¥ 3â€“5 ä¸ªæƒ…ç»ªè¯ä¸²è”\n   * `target_audience`: ç”¨ä¸€å¥è¯æ¦‚æ‹¬å—ä¼—ç¾¤ä½“\n   * `human_insight`: ä¸€å¥è¯æ­ç¤ºå¿ƒç†æ´å¯Ÿ\n   * `video_duration_estimate`: `\"çº¦ X åˆ†é’Ÿ\"`ï¼ˆ1â€“7 åˆ†é’ŸèŒƒå›´å†…ä¼°è®¡ï¼‰\n\n---\n\n## âœ… æ£€æŸ¥æ¸…å•ï¼ˆå†…éƒ¨æ ¡éªŒï¼‰\n* æ‰€æœ‰ `narration_script` é€å­—ä¿çœŸ\n* `scene_id` è¿ç»­é€’å¢\n* `\"speaking\"` ä»…ä¸º `\"Yes\"` æˆ– `\"No\"`\n* å½“ `\"No\"` æ—¶ï¼Œ`visual` å¿…é¡»å­˜åœ¨ä¸”åˆè§„\n* è¾“å‡ºä¸º**å•ä¸€ JSON å¯¹è±¡**ï¼Œæ— ä»»ä½•å¤šä½™æ–‡å­—",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1552,
        480
      ],
      "id": "7e642c51-3fcc-4b1d-abb6-e0704d84c626",
      "name": "è‡ªå®šä¹‰è„šæœ¬"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $('æäº¤å†…å®¹').item.json[\"è§†é¢‘å†…å®¹\"] }}"
            }
          ]
        },
        "options": {
          "systemMessage": "={{ $json['è„šæœ¬'] }}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        1776,
        480
      ],
      "id": "31ebe9a0-fd67-44b0-b858-378d71ac8844",
      "name": "Message a model",
      "credentials": {
        "googlePalmApi": {
          "id": "RzWCy4Le1VMm7gtf",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const results = [];\n\nconst textInput = $input.first().json.content.parts[0].text;\n\nconst jsonMatch = textInput.match(/```json\\s*([\\s\\S]*?)```/); \n\nlet jsonString;\nif (jsonMatch && jsonMatch[1]) {\n    jsonString = jsonMatch[1].trim();\n} else {\n    jsonString = textInput.trim(); \n}\n\nlet parsedData;\nlet cleanJsonString = jsonString; \n\ntry {\n    const contentMatch = cleanJsonString.match(/\\{[\\s\\S]*\\}/);\n    if (contentMatch) {\n        cleanJsonString = contentMatch[0].trim();\n    } else {\n        throw new Error(\"Cannot find valid JSON object structure {}.\");\n    }\n\n    cleanJsonString = cleanJsonString.replace(/narration\\s*Ascript/g, 'narration_script');\n    \n    cleanJsonString = cleanJsonString.replace(/scenscenescene_id|scenescene_id/g, 'scene_id');\n\n    cleanJsonString = cleanJsonString.replace(/([\\{\\,]\\s*)(scene_id|e_id|_id)\\s*:\\s*(\\d+)/g, '$1\"scene_id\":$3');\n\n    cleanJsonString = cleanJsonString.replace(/([\\{\\,]\\s*)scene_id\\s*:\\s*(\\d+)/g, '$1\"scene_id\":$2');\n\n    cleanJsonString = cleanJsonString.replace(/(\\r\\n|\\n|\\r)/gm, ' ').trim();\n\n    cleanJsonString = cleanJsonString.replace(/,\\s*([}\\]])/g, '$1');\n\n    cleanJsonString = cleanJsonString.replace(/([{,]\\s*)'([a-zA-Z0-9_]+)'\\s*:/g, '$1\"$2\":'); \n    cleanJsonString = cleanJsonString.replace(/([{,]\\s*)([a-zA-Z0-9_]+)\\s*:/g, '$1\"$2\":'); \n\n    cleanJsonString = cleanJsonString.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, '').trim();\n\n    cleanJsonString = cleanJsonString.replace(/\\s{2,}/g, ' '); \n\n    cleanJsonString = cleanJsonString.replace(/([\\\"}\\]0-9])\\s+[-\\s]*\\s*([,}\\]])/g, '$1$2');\n\n    parsedData = JSON.parse(cleanJsonString); \n\n    results.push({\n        json: {\n            \"æ—ç™½\": parsedData, \n            \"å®Œæ•´æ—ç™½\": textInput \n        }\n    });\n\n} catch (e) {\n    console.error(\"JSON Parsing Failed:\", e.message);\n    \n    results.push({ \n        json: { \n            \"error\": `JSON Parse Error: ${e.message}`, \n            \"debug_input_full\": cleanJsonString,\n            \"debug_input_start\": cleanJsonString.substring(0, 500) + '...' \n        } \n    });\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2128,
        480
      ],
      "id": "bbc4d744-9c1f-4148-aa42-7edb0e666e41",
      "name": "æå–æ—ç™½"
    },
    {
      "parameters": {
        "fieldToSplitOut": "['æ—ç™½'].storyboards",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2352,
        480
      ],
      "id": "7144ce1b-7258-4b53-a1a4-8bd340b9c026",
      "name": "éå†"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2576,
        480
      ],
      "id": "22147214-363d-4f32-a8be-dd72c87f484f",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.minimax.io/v1/t2a_v2",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer sk-api-vekESrm_vFTFZJV6JT7oJMKwj66SYAr0FxfMuqc2wSuS3VPLcjAOQ396rYpwAOZvcYa6KAZOkV6UvmT17b55ZBN4_Ys7YNZK9_gMR4GQLqphD0g-1y1iIS8"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"model\":\"speech-2.6-hd\",\n    \"text\": \"{{ $('éå†').item.json.narration_script }}\",\n    \"stream\":false,\n    \"language_boost\":\"auto\",\n    \"output_format\":\"url\",\n    \"voice_setting\":{\n        \"voice_id\":\"English_AttractiveGirl\",\n        \"speed\":1.4,\n        \"vol\":1.2,\n        \"pitch\":0\n    },\n    \"pronunciation_dict\":{\n        \"tone\":[\n            \"\"\n        ]\n    },\n    \"audio_setting\":{\n        \"sample_rate\":44100,\n        \"bitrate\":256000,\n        \"format\":\"mp3\",\n        \"channel\":2\n    },\n    \"voice_modify\":{\n      \"pitch\":0,\n      \"intensity\":0,\n      \"timbre\":0\n    }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2800,
        480
      ],
      "id": "cd0687eb-58f8-44df-a8e9-bef882f86a66",
      "name": "ç”ŸæˆéŸ³é¢‘",
      "retryOnFail": true
    },
    {
      "parameters": {
        "amount": 1,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3616,
        224
      ],
      "id": "6787de72-c093-43af-a97e-6e50af7baefe",
      "name": "ç­‰å¾…æäº¤",
      "webhookId": "ac2dd6ab-7e30-4253-899d-a5a56bbfffbf"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.msg }}",
                    "rightValue": "success",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a8415637-7674-432d-93d7-7918aceabf55"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "success"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "2cdf2e6e-7936-4c05-9e1f-93fa0c445792",
                    "leftValue": "={{ $json.msg }}",
                    "rightValue": "TASK_QUEUE_MAXED",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "TASK_QUEUE_MAXED"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        3248,
        208
      ],
      "id": "87de3553-ecb8-49f3-ba34-5928d3c25bfe",
      "name": "æ¥ä»»åŠ¡"
    },
    {
      "parameters": {
        "amount": 120
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3456,
        64
      ],
      "id": "7ef7e119-d3d6-43ab-8ce7-9610d00de16f",
      "name": "ç­‰å¾…ç”Ÿæˆè§†é¢‘",
      "webhookId": "1697154e-1e29-4137-baa7-c06d4f1abd61"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.ai/task/openapi/status",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.ai"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['Running Hub API_KEY'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('å¯¹å˜´è§†é¢‘ç¼–è¾‘').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3696,
        64
      ],
      "id": "21cfd940-4eb5-4703-8b64-e35acfcdd5e7",
      "name": "ä»»åŠ¡çŠ¶æ€-å¯¹å˜´",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.ai/task/openapi/outputs",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.ai"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['Running Hub API_KEY'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('å¯¹å˜´è§†é¢‘ç¼–è¾‘').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        4128,
        448
      ],
      "id": "905db4cb-da83-447d-baf3-2943b3f2d79c",
      "name": "è·å–è§†é¢‘",
      "retryOnFail": true,
      "maxTries": 5
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "3ca92e30-f172-4f8d-a589-81a6c3165f4f",
              "name": "è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€",
              "value": "={{ $json.data[0].fileUrl }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4320,
        464
      ],
      "id": "f0ac01a9-c8cc-4447-a417-2b1656bed2e4",
      "name": "è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        2800,
        304
      ],
      "id": "945a6e4c-a14e-4b47-80a5-63bf13b0419d",
      "name": "èšåˆ"
    },
    {
      "parameters": {
        "resource": "object",
        "operation": "create",
        "bucketName": "=n8n-website",
        "objectName": "={{ $workflow.id }}.png",
        "createBinaryPropertyName": "Image",
        "createData": {},
        "createQuery": {},
        "encryptionHeaders": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.googleCloudStorage",
      "typeVersion": 1,
      "position": [
        1104,
        480
      ],
      "id": "10731a2b-9f52-42b7-be1c-e6b0fc8ca012",
      "name": "ä¸Šä¼ å›¾ç‰‡",
      "credentials": {
        "googleCloudStorageOAuth2Api": {
          "id": "NbDcUZkrVBPdzAVc",
          "name": "n8n"
        }
      }
    },
    {
      "parameters": {
        "formTitle": "OddsFlow å£æ’­è§†é¢‘",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Image",
              "fieldType": "file",
              "acceptFileTypes": ".jpg, .jpeg, .png"
            },
            {
              "fieldLabel": "è§†é¢‘å†…å®¹",
              "fieldType": "textarea"
            },
            {
              "fieldLabel": "submissionId",
              "fieldType": "text"
            },
            {
              "fieldLabel": "callbackUrl",
              "fieldType": "text"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        880,
        480
      ],
      "id": "d26116f8-6852-409a-ac7e-8ef68fa708e5",
      "name": "æäº¤å†…å®¹",
      "webhookId": "a10e0d8f-1a9c-478f-9108-e98789783996"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.ai/task/openapi/ai-app/run",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.ai"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"webappId\": \"1962418130934960130\",\n  \"apiKey\": \"{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['Running Hub API_KEY'] }}\",\n  \"nodeInfoList\": [\n    {\n      \"nodeId\": \"133\",\n      \"fieldName\": \"image\",\n      \"fieldValue\": \"{{ $('ä¸Šä¼ å›¾ç‰‡').first().json.mediaLink }}\",\n      \"description\": \"image\"\n    },\n    {\n      \"nodeId\": \"135\",\n      \"fieldName\": \"positive_prompt\",\n      \"fieldValue\": \"ä¸€ä¸ªäººåœ¨è¯´è¯\",\n      \"description\": \"positive_prompt\"\n    },\n    {\n      \"nodeId\": \"125\",\n      \"fieldName\": \"audio\",\n      \"fieldValue\": \"{{ $('ç”ŸæˆéŸ³é¢‘').item.json.data.audio }}\",\n      \"description\": \"audio\"\n    }\n  ]\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3056,
        432
      ],
      "id": "3378f9ac-1a50-4b9c-b111-52cf62e77e8d",
      "name": "å¯¹å˜´è§†é¢‘ç¼–è¾‘",
      "retryOnFail": true,
      "maxTries": 3
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.data }}",
                    "rightValue": "QUEUED",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a8415637-7674-432d-93d7-7918aceabf55"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "QUEUED"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "acfc59b6-6d87-4899-8ead-c84a4877a873",
                    "leftValue": "={{ $json.data }}",
                    "rightValue": "RUNNING",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "RUNNING"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6e3fffa5-a3a3-41b6-a9c0-4a9b7c76e0c6",
                    "leftValue": "={{ $json.data }}",
                    "rightValue": "SUCCESS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "SUCCESS"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f9edde64-be39-4a18-ace9-133018c2edcd",
                    "leftValue": "={{ $json.data }}",
                    "rightValue": "FAILED",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "FAILED"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        3888,
        320
      ],
      "id": "3ff7102b-afd7-4fc6-9b54-9228f3b5ba5e",
      "name": "ä»»åŠ¡è·¯ç”±"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('æäº¤å†…å®¹').first().json.callbackUrl }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"submissionId\": \"{{ $('æäº¤å†…å®¹').first().json.submissionId }}\",\n  \"status\": \"completed\",\n  \"progress\": 100,\n  \"currentStep\": \"Lip sync video ready\",\n  \"videoUrl\": \"{{ $json.data[0]['è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€'] }}\",\n  \"videoTitle\": \"Lip Sync Video - {{ $now.format('yyyy-MM-dd HH:mm') }}\"\n}",
        "options": {
          "response": {
            "response": {
              "neverError": true
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3024,
        304
      ],
      "id": "callback-to-website",
      "name": "Callback to Website"
    }
  ],
  "connections": {
    "è®¾ç½®å‚æ•°-ç»¼åˆ": {
      "main": [
        [
          {
            "node": "è‡ªå®šä¹‰è„šæœ¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è‡ªå®šä¹‰è„šæœ¬": {
      "main": [
        [
          {
            "node": "Message a model",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model": {
      "main": [
        [
          {
            "node": "æå–æ—ç™½",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æå–æ—ç™½": {
      "main": [
        [
          {
            "node": "éå†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "éå†": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "èšåˆ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ç”ŸæˆéŸ³é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”ŸæˆéŸ³é¢‘": {
      "main": [
        [
          {
            "node": "å¯¹å˜´è§†é¢‘ç¼–è¾‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­‰å¾…æäº¤": {
      "main": [
        [
          {
            "node": "å¯¹å˜´è§†é¢‘ç¼–è¾‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¥ä»»åŠ¡": {
      "main": [
        [
          {
            "node": "ç­‰å¾…ç”Ÿæˆè§†é¢‘",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ç­‰å¾…æäº¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­‰å¾…ç”Ÿæˆè§†é¢‘": {
      "main": [
        [
          {
            "node": "ä»»åŠ¡çŠ¶æ€-å¯¹å˜´",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä»»åŠ¡çŠ¶æ€-å¯¹å˜´": {
      "main": [
        [
          {
            "node": "ä»»åŠ¡è·¯ç”±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–è§†é¢‘": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸Šä¼ å›¾ç‰‡": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-ç»¼åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æäº¤å†…å®¹": {
      "main": [
        [
          {
            "node": "ä¸Šä¼ å›¾ç‰‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å¯¹å˜´è§†é¢‘ç¼–è¾‘": {
      "main": [
        [
          {
            "node": "æ¥ä»»åŠ¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä»»åŠ¡è·¯ç”±": {
      "main": [
        [
          {
            "node": "ç­‰å¾…ç”Ÿæˆè§†é¢‘",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ç­‰å¾…ç”Ÿæˆè§†é¢‘",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è·å–è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "å¯¹å˜´è§†é¢‘ç¼–è¾‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èšåˆ": {
      "main": [
        [
          {
            "node": "Callback to Website",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "05e3543f68c394ceb082bf8d2ef8d2b149f35ecddcbc0afb7e81bd6933faf98c"
  }
}
